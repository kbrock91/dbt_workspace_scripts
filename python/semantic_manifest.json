{
    "semantic_models": [
        {
            "name": "customers",
            "defaults": {
                "agg_time_dimension": "first_ordered_at"
            },
            "description": "Customer grain mart.\n",
            "node_relation": {
                "alias": "dim_customers",
                "schema_name": "dbt_pkearns",
                "database": "DEVELOPMENT",
                "relation_name": "DEVELOPMENT.dbt_pkearns.dim_customers"
            },
            "primary_entity": null,
            "entities": [
                {
                    "name": "customer",
                    "description": null,
                    "type": "primary",
                    "role": null,
                    "expr": "customer_id",
                    "metadata": null,
                    "label": null
                }
            ],
            "measures": [
                {
                    "name": "count_lifetime_orders",
                    "agg": "sum",
                    "description": "Total count of orders per customer.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "lifetime_spend_pretax",
                    "agg": "sum",
                    "description": "Customer lifetime spend before taxes.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "lifetime_spend",
                    "agg": "sum",
                    "description": "Gross customer lifetime spend inclusive of taxes.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "count_distinct_customers",
                    "agg": "count_distinct",
                    "description": null,
                    "create_metric": false,
                    "expr": "customer_id",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                }
            ],
            "dimensions": [
                {
                    "name": "customer_name",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "customer_type",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "first_ordered_at",
                    "description": null,
                    "type": "time",
                    "is_partition": false,
                    "type_params": {
                        "time_granularity": "day",
                        "validity_params": null
                    },
                    "expr": null,
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "last_ordered_at",
                    "description": null,
                    "type": "time",
                    "is_partition": false,
                    "type_params": {
                        "time_granularity": "day",
                        "validity_params": null
                    },
                    "expr": null,
                    "metadata": null,
                    "label": null
                }
            ],
            "label": null,
            "metadata": null,
            "config": {
                "meta": {}
            }
        },
        {
            "name": "orders",
            "defaults": {
                "agg_time_dimension": "ordered_at"
            },
            "description": "Order fact table. This table is at the order grain with one row per order.\n",
            "node_relation": {
                "alias": "fct_orders",
                "schema_name": "dbt_pkearns",
                "database": "DEVELOPMENT",
                "relation_name": "DEVELOPMENT.dbt_pkearns.fct_orders"
            },
            "primary_entity": null,
            "entities": [
                {
                    "name": "orders",
                    "description": null,
                    "type": "primary",
                    "role": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "location",
                    "description": null,
                    "type": "foreign",
                    "role": null,
                    "expr": "location_id",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "customer",
                    "description": null,
                    "type": "foreign",
                    "role": null,
                    "expr": "customer_id",
                    "metadata": null,
                    "label": null
                }
            ],
            "measures": [
                {
                    "name": "order_total",
                    "agg": "sum",
                    "description": "The total amount for each order including taxes.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "order_count",
                    "agg": "sum",
                    "description": null,
                    "create_metric": false,
                    "expr": "1",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "tax_paid",
                    "agg": "sum",
                    "description": "The total tax paid on each order.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "customers_with_orders",
                    "agg": "count_distinct",
                    "description": "Distinct count of customers placing orders",
                    "create_metric": false,
                    "expr": "customer_id",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "locations_with_orders",
                    "agg": "count_distinct",
                    "description": "Distinct count of locations with order",
                    "create_metric": false,
                    "expr": "location_id",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "order_cost",
                    "agg": "sum",
                    "description": "The cost for each order item. Cost is calculated as a sum of the supply cost for each order item.",
                    "create_metric": false,
                    "expr": null,
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "order_value_p99",
                    "agg": "percentile",
                    "description": null,
                    "create_metric": false,
                    "expr": "order_total",
                    "agg_params": {
                        "percentile": 0.99,
                        "use_discrete_percentile": true,
                        "use_approximate_percentile": false
                    },
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "discrete_order_value_p99",
                    "agg": "percentile",
                    "description": null,
                    "create_metric": false,
                    "expr": "order_total",
                    "agg_params": {
                        "percentile": 0.99,
                        "use_discrete_percentile": true,
                        "use_approximate_percentile": false
                    },
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "food_order_total",
                    "agg": "sum",
                    "description": null,
                    "create_metric": false,
                    "expr": "case when is_food_order then order_total else 0 end",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "max_order_value",
                    "agg": "max",
                    "description": null,
                    "create_metric": false,
                    "expr": "order_total",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": "ordered_at",
                    "label": null
                },
                {
                    "name": "min_order_value",
                    "agg": "min",
                    "description": null,
                    "create_metric": false,
                    "expr": "order_total",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                }
            ],
            "dimensions": [
                {
                    "name": "ordered_at",
                    "description": null,
                    "type": "time",
                    "is_partition": false,
                    "type_params": {
                        "time_granularity": "day",
                        "validity_params": null
                    },
                    "expr": "date_trunc('day', ordered_at)",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "order_total_dim",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": "order_total",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "is_food_order",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                }
            ],
            "label": null,
            "metadata": null,
            "config": {
                "meta": {}
            }
        },
        {
            "name": "order_item",
            "defaults": {
                "agg_time_dimension": "ordered_at"
            },
            "description": "Items contatined in each order. The grain of the table is one row per order item.\n",
            "node_relation": {
                "alias": "order_items",
                "schema_name": "dbt_pkearns",
                "database": "DEVELOPMENT",
                "relation_name": "DEVELOPMENT.dbt_pkearns.order_items"
            },
            "primary_entity": null,
            "entities": [
                {
                    "name": "order_item",
                    "description": null,
                    "type": "primary",
                    "role": null,
                    "expr": "order_item_id",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "order_id",
                    "description": null,
                    "type": "foreign",
                    "role": null,
                    "expr": "order_id",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "product",
                    "description": null,
                    "type": "foreign",
                    "role": null,
                    "expr": "product_id",
                    "metadata": null,
                    "label": null
                }
            ],
            "measures": [
                {
                    "name": "revenue",
                    "agg": "sum",
                    "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
                    "create_metric": false,
                    "expr": "product_price",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "food_revenue",
                    "agg": "sum",
                    "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
                    "create_metric": false,
                    "expr": "case when is_food_item = 1 then product_price else 0 end",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                },
                {
                    "name": "drink_revenue",
                    "agg": "sum",
                    "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
                    "create_metric": false,
                    "expr": "case when is_drink_item = 1 then product_price else 0 end",
                    "agg_params": null,
                    "metadata": null,
                    "non_additive_dimension": null,
                    "agg_time_dimension": null,
                    "label": null
                }
            ],
            "dimensions": [
                {
                    "name": "ordered_at",
                    "description": null,
                    "type": "time",
                    "is_partition": false,
                    "type_params": {
                        "time_granularity": "day",
                        "validity_params": null
                    },
                    "expr": "date_trunc('day', ordered_at)",
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "is_food_item",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                },
                {
                    "name": "is_drink_item",
                    "description": null,
                    "type": "categorical",
                    "is_partition": false,
                    "type_params": null,
                    "expr": null,
                    "metadata": null,
                    "label": null
                }
            ],
            "label": null,
            "metadata": null,
            "config": {
                "meta": {}
            }
        }
    ],
    "metrics": [
        {
            "name": "met_count_distinct_customers",
            "description": "Count of customers",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "count_distinct_customers",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "count_distinct_customers",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "customers",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_customers_with_orders",
            "description": "Unique count of customers placing orders",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "count_distinct_customers",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "count_distinct_customers",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "customers_with_orders",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_order_total",
            "description": "Sum of orders value",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "order_total",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_food_order_total",
            "description": "Sum of orders value if food order",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "food_order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "food_order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "food_order_total",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_order_count",
            "description": "The number of orders placed",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_count",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_count",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "order_count",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_locations_with_orders",
            "description": "The number of locations that have orders.",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "locations_with_orders",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "locations_with_orders",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "locations_with_orders",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_order_value_p99",
            "description": "The 99th percentile of each order",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_value_p99",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_value_p99",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "order_value_p99",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_discrete_order_value_p99",
            "description": "The 99th percentile of each order using a discrete distribution",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_value_p99",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_value_p99",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "discrete_order_value_p99",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_large_order",
            "description": "Count of orders with order total over 20.",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_count",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_count",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": {
                "where_filters": [
                    {
                        "where_sql_template": "{{ Dimension('order_id__order_total_dim') }} >= 20\n"
                    }
                ]
            },
            "metadata": null,
            "label": "Large Orders",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_food_order_amount",
            "description": "Sum order amount for food orders.",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "food_order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "food_order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "food_order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_max_order_amount",
            "description": "The highest order value for a given period",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "max_order_value",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "max_order_value",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "max_order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_min_order_amount",
            "description": "The lowest order value for a given period",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "min_order_value",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "min_order_value",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "min_order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_new_customers",
            "description": "Unique count of new customers.",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "customers_with_orders",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "customers_with_orders",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": {
                "where_filters": [
                    {
                        "where_sql_template": "{{ Dimension('customer__customer_type') }}  = 'new'\n"
                    }
                ]
            },
            "metadata": null,
            "label": "New Customers",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_order_amount",
            "description": "The cost of fulfilling each order",
            "type": "simple",
            "type_params": {
                "measure": {
                    "name": "order_cost",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_cost",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_food_order_pct",
            "description": "The food cost as the % of the total order",
            "type": "ratio",
            "type_params": {
                "measure": null,
                "numerator": {
                    "name": "met_food_order_amount",
                    "filter": null,
                    "alias": null,
                    "offset_window": null,
                    "offset_to_grain": null
                },
                "denominator": {
                    "name": "met_order_total",
                    "filter": null,
                    "alias": null,
                    "offset_window": null,
                    "offset_to_grain": null
                },
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "food_order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    },
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "food_order_pct",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_food_order_pct_cumulative",
            "description": "Food order total as a % of total order amount",
            "type": "derived",
            "type_params": {
                "measure": null,
                "numerator": null,
                "denominator": null,
                "expr": "met_food_order_pct * 100",
                "window": null,
                "grain_to_date": null,
                "metrics": [
                    {
                        "name": "met_food_order_pct",
                        "filter": null,
                        "alias": null,
                        "offset_window": null,
                        "offset_to_grain": null
                    }
                ],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "food_order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    },
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "food_order_as_percent_of_total_order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_food_order_gross_profit",
            "description": "The gross profit for each food order",
            "type": "derived",
            "type_params": {
                "measure": null,
                "numerator": null,
                "denominator": null,
                "expr": "food_revenue - food_cost",
                "window": null,
                "grain_to_date": null,
                "metrics": [
                    {
                        "name": "met_food_order_total",
                        "filter": null,
                        "alias": "food_revenue",
                        "offset_window": null,
                        "offset_to_grain": null
                    },
                    {
                        "name": "met_food_order_amount",
                        "filter": null,
                        "alias": "food_cost",
                        "offset_window": null,
                        "offset_to_grain": null
                    }
                ],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "food_order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "food_order_gross_profit",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_order_gross_profit",
            "description": "The gross profit for each order",
            "type": "derived",
            "type_params": {
                "measure": null,
                "numerator": null,
                "denominator": null,
                "expr": "revenue - cost",
                "window": null,
                "grain_to_date": null,
                "metrics": [
                    {
                        "name": "met_order_total",
                        "filter": null,
                        "alias": "revenue",
                        "offset_window": null,
                        "offset_to_grain": null
                    },
                    {
                        "name": "met_order_amount",
                        "filter": null,
                        "alias": "cost",
                        "offset_window": null,
                        "offset_to_grain": null
                    }
                ],
                "conversion_type_params": null,
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    },
                    {
                        "name": "order_cost",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "order_gross_profit",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_cumulative_order_amount",
            "description": "The cumulative value of all orders",
            "type": "cumulative",
            "type_params": {
                "measure": {
                    "name": "order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": {
                    "window": null,
                    "grain_to_date": null,
                    "period_agg": "first"
                },
                "input_measures": [
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "cumulative_order_amount",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_cumulative_order_ammount_l1m",
            "description": "Trailing 1 month cumulative order amount",
            "type": "cumulative",
            "type_params": {
                "measure": {
                    "name": "order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": {
                    "count": 1,
                    "granularity": "month"
                },
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": {
                    "window": {
                        "count": 1,
                        "granularity": "month"
                    },
                    "grain_to_date": null,
                    "period_agg": "first"
                },
                "input_measures": [
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "cumulative_order_ammount_l1m",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "met_cumulative_order_amount_mtd",
            "description": "The month to date value of all orders",
            "type": "cumulative",
            "type_params": {
                "measure": {
                    "name": "order_total",
                    "filter": null,
                    "alias": null,
                    "join_to_timespine": false,
                    "fill_nulls_with": null
                },
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": "month",
                "metrics": [],
                "conversion_type_params": null,
                "cumulative_type_params": {
                    "window": null,
                    "grain_to_date": "month",
                    "period_agg": "first"
                },
                "input_measures": [
                    {
                        "name": "order_total",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": null
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "cumulative_order_amount_mtd",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        },
        {
            "name": "visit_to_buy_conversion",
            "description": "Conversion rate from visiting to transaction in 7 days",
            "type": "conversion",
            "type_params": {
                "measure": null,
                "numerator": null,
                "denominator": null,
                "expr": null,
                "window": null,
                "grain_to_date": null,
                "metrics": [],
                "conversion_type_params": {
                    "base_measure": {
                        "name": "order_count",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": 0
                    },
                    "conversion_measure": {
                        "name": "order_count",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": 0
                    },
                    "entity": "orders",
                    "calculation": "conversion_rate",
                    "window": {
                        "count": 7,
                        "granularity": "day"
                    },
                    "constant_properties": null
                },
                "cumulative_type_params": null,
                "input_measures": [
                    {
                        "name": "order_count",
                        "filter": null,
                        "alias": null,
                        "join_to_timespine": false,
                        "fill_nulls_with": 0
                    }
                ]
            },
            "filter": null,
            "metadata": null,
            "label": "Visit to Buy Conversion Rate (7-day window)",
            "config": {
                "meta": {}
            },
            "time_granularity": null
        }
    ],
    "project_configuration": {
        "time_spine_table_configurations": [
            {
                "location": "DEVELOPMENT.dbt_pkearns.metricflow_time_spine",
                "column_name": "date_day",
                "grain": "day"
            }
        ],
        "metadata": null,
        "dsi_package_version": {
            "major_version": "0",
            "minor_version": "6",
            "patch_version": "11"
        },
        "time_spines": []
    },
    "saved_queries": [
        {
            "name": "sl_order_daily",
            "query_params": {
                "metrics": [
                    "met_order_total",
                    "met_food_order_total",
                    "met_order_count",
                    "met_order_value_p99",
                    "met_max_order_amount",
                    "met_min_order_amount",
                    "met_order_gross_profit"
                ],
                "group_by": [
                    "TimeDimension('metric_time', 'day')",
                    "Entity('orders__location')"
                ],
                "where": null
            },
            "description": "order info at daily level",
            "metadata": null,
            "label": "Order Item daily",
            "exports": [
                {
                    "name": "order_daily_exp",
                    "config": {
                        "export_as": "table",
                        "schema_name": "dbt_pkearns",
                        "alias": "order_daily_exp"
                    }
                }
            ]
        },
        {
            "name": "sl_order_monthly",
            "query_params": {
                "metrics": [
                    "met_order_total",
                    "met_food_order_total",
                    "met_order_count",
                    "met_order_value_p99",
                    "met_max_order_amount",
                    "met_min_order_amount",
                    "met_order_gross_profit"
                ],
                "group_by": [
                    "TimeDimension('metric_time', 'month')",
                    "Entity('orders__location')"
                ],
                "where": null
            },
            "description": "order info at monthly level",
            "metadata": null,
            "label": "Order Item monthly",
            "exports": [
                {
                    "name": "order_monthly_exp",
                    "config": {
                        "export_as": "table",
                        "schema_name": "dbt_pkearns",
                        "alias": "order_monthly_exp"
                    }
                }
            ]
        },
        {
            "name": "sl_customers",
            "query_params": {
                "metrics": [
                    "met_order_total",
                    "met_food_order_total",
                    "met_order_count",
                    "met_order_value_p99",
                    "met_max_order_amount",
                    "met_min_order_amount",
                    "met_food_order_pct",
                    "met_order_gross_profit"
                ],
                "group_by": [
                    "Dimension('customer__customer_name')",
                    "Dimension('customer__customer_type')",
                    "Dimension('customer__first_ordered_at')"
                ],
                "where": null
            },
            "description": "Orders by Customer",
            "metadata": null,
            "label": "Customer Orders",
            "exports": [
                {
                    "name": "customers_exp",
                    "config": {
                        "export_as": "table",
                        "schema_name": "dbt_pkearns",
                        "alias": "customers_exp"
                    }
                }
            ]
        }
    ]
}